// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../../../../node_modules/.prisma/teamogram-client"
}

datasource db {
  provider = "mysql"
  url      = env("TEAMOGRAM_SOURCE_URL")
}

model UserNameGivenByKasper {
  id            Int      @id
  title         String
  createdDate   DateTime @default(now())
  updatedDate   DateTime @updatedAt
  givenScore    Score[]  @relation("GivingScore")
  ressivedScore Score[]  @relation("RessiviedScore")
}

model Score {
  id                   Int                   @id @default(autoincrement())
  value                Int
  text                 String
  targetTelegramUserId Int
  givingTelegramUserId Int
  givingUserName       UserNameGivenByKasper @relation("GivingScore", fields: [givingTelegramUserId], references: [id])
  targetUserName       UserNameGivenByKasper @relation("RessiviedScore", fields: [targetTelegramUserId], references: [id])
  telegramChatId       BigInt
  telegramMessageJson  Json
  createdDate          DateTime              @default(now())
  updatedDate          DateTime              @updatedAt

  @@index([telegramChatId, targetTelegramUserId, givingTelegramUserId, createdDate(sort: Desc)])
}
